# Zephyr ELI5: –û—Ç –Ω–æ–≤–∏—á–∫–∞ ‚Äî –Ω–æ–≤–∏—á–∫–∞–º. –ß–∞—Å—Ç—å 1: –°–æ–∑–¥–∞–Ω–∏–µ –∫–∞—Å—Ç–æ–º–Ω–æ–π –ø–ª–∞—Ç—ã

–ü—Ä–∏–≤–µ—Ç, —Ä–µ–±—è—Ç–∞! üëã  
–≠—Ç–æ –ø–µ—Ä–≤—ã–π –ø–æ—Å—Ç –≤ —Å–µ—Ä–∏–∏ **¬´Zephyr ELI5: –û—Ç –Ω–æ–≤–∏—á–∫–∞ ‚Äî –Ω–æ–≤–∏—á–∫–∞–º¬ª**, –≥–¥–µ —è ‚Äî —á–µ–ª–æ–≤–µ–∫, –∫–æ—Ç–æ—Ä—ã–π –∏–∑—É—á–∞–µ—Ç Zephyr —Ç–∞–∫ –∂–µ, –∫–∞–∫ –∏ –≤—ã ‚Äî –¥–µ–ª—é—Å—å —Å–≤–æ–∏–º –æ–ø—ã—Ç–æ–º. –ú—ã –±—É–¥–µ–º —à–∞–≥ –∑–∞ —à–∞–≥–æ–º —Ä–∞–∑–±–∏—Ä–∞—Ç—å –ø—Ä–æ—Ü–µ—Å—Å –æ–ø–∏—Å–∞–Ω–∏—è –∫–∞—Å—Ç–æ–º–Ω–æ–π –ø–ª–∞—Ç—ã –≤ Zephyr: —Å–æ–∑–¥–∞–Ω–∏–µ `.dts`, `Kconfig`, `board.yml` –∏ –≤—Å–µ–≥–æ, —á—Ç–æ –Ω—É–∂–Ω–æ, —á—Ç–æ–±—ã –≤–∞—à–∞ –ø–ª–∞—Ç–∞ –∑–∞—Ä–∞–±–æ—Ç–∞–ª–∞ —Å Zephyr.

–ú—ã –±—É–¥–µ–º –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –ø–ª–∞—Ç—É WeAct —Å —á–∏–ø–æ–º **STM32F401CEU6**. –Ø —Ä–∞–±–æ—Ç–∞—é –Ω–∞ **macOS** —Å **Zephyr v4.2.0**.

> ‚ö†Ô∏è –Ø –Ω–µ –ø—Ä–µ—Ç–µ–Ω–¥—É—é –Ω–∞ 100% –ø—Ä–∞–≤–∏–ª—å–Ω–æ—Å—Ç—å –∏ –ø–æ–ª–Ω–æ–µ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ –æ—Ñ–∏—Ü–∏–∞–ª—å–Ω—ã–º –ø—Ä–∞–∫—Ç–∏–∫–∞–º. –ï—Å–ª–∏ –≤—ã ‚Äî —ç–∫—Å–ø–µ—Ä—Ç –≤ Zephyr, –±—É–¥—É —Ä–∞–¥ –≤–∞—à–∏–º –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏—è–º!

---

## üí° –ü–ª–∞–Ω —Å–µ—Ä–∏–∏

- **–ß–∞—Å—Ç—å 2** ‚Äî –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ Ethernet-—á–∏–ø–∞ W5500  
- **–ß–∞—Å—Ç—å 1** ‚Äî –°–æ–∑–¥–∞–Ω–∏–µ –æ–ø–∏—Å–∞–Ω–∏—è –ø–ª–∞—Ç—ã: `dts`, `Kconfig`, `board.yml`
- **(–í–æ–∑–º–æ–∂–Ω–æ –ø–æ–∑–∂–µ)** –ß–∞—Å—Ç—å 0 ‚Äî –£—Å—Ç–∞–Ω–æ–≤–∫–∞ Zephyr SDK –∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ CLion IDE

> –ï—Å–ª–∏ —ç—Ç–æ—Ç –ø–æ—Å—Ç –æ–∫–∞–∂–µ—Ç—Å—è –ø–æ–ª–µ–∑–Ω—ã–º, —è –Ω–∞–ø–∏—à—É —Å–ª–µ–¥—É—é—â–∏–µ —Å—Ç–∞—Ç—å–∏!

---

## üìö –ü–æ–ª–µ–∑–Ω—ã–µ –æ—Ñ–∏—Ü–∏–∞–ª—å–Ω—ã–µ —Ä–µ—Å—É—Ä—Å—ã

- üß≠ **–ì–∞–π–¥ –ø–æ –ø–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω–∏—é –ø–ª–∞—Ç**  
  https://docs.zephyrproject.org/latest/hardware/porting/board_porting.html

- üå≥ **–í–≤–µ–¥–µ–Ω–∏–µ –≤ DeviceTree**  
  https://docs.zephyrproject.org/latest/build/dts/intro.html#devicetree-intro

---

## üß∞ –ß—Ç–æ –ø–æ–Ω–∞–¥–æ–±–∏—Ç—Å—è

- **STM32CubeMX** –∏–ª–∏ **STM32CubeIDE** ‚Äî –æ—á–µ–Ω—å —É–¥–æ–±–Ω–æ –¥–ª—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ —Ç–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è.
- **–£—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—ã–π Zephyr SDK** (–≤ –º–æ–µ–º —Å–ª—É—á–∞–µ ‚Äî –≤ `~/zephyrproject`)

---

## üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

–£ –º–µ–Ω—è Zephyr —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω –∑–¥–µ—Å—å:

```bash
/Users/kiro/
‚îú‚îÄ‚îÄ zephyrproject/zephyr/
‚îî‚îÄ‚îÄ zephyr-sdk-0.17.4/
```

---

## üìç –ì–¥–µ —Å–æ–∑–¥–∞—Ç—å –æ–ø–∏—Å–∞–Ω–∏–µ –ø–ª–∞—Ç—ã

–í–Ω—É—Ç—Ä–∏ `zephyr/boards/arm` —Å–æ–∑–¥–∞—ë–º –Ω–æ–≤—É—é –ø–∞–ø–∫—É –¥–ª—è –ø–ª–∞—Ç—ã:

```bash
cd ~/zephyrproject/zephyr/boards/arm
mkdir reddit_board
cd reddit_board
```

> –ú—ã –±—É–¥–µ–º –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –æ–¥–∏–Ω–∞–∫–æ–≤–æ–µ –∏–º—è –¥–ª—è –ø–∞–ø–∫–∏ –∏ –ø–ª–∞—Ç—ã: `reddit_board`

---

## üß© –®–∞–≥ 1: –§–∞–π–ª `Kconfig.reddit_board`

```bash
touch ~/zephyrproject/zephyr/boards/arm/reddit_board/Kconfig.reddit_board
```

–°–æ–¥–µ—Ä–∂–∏–º–æ–µ:

```kconfig
config BOARD_REDDIT_BOARD
	select SOC_STM32F401XE
```

> –°–∏–º–≤–æ–ª `SOC_STM32F401XE` –±–µ—Ä—ë–º –∏–∑ `soc/st/stm32/stm32f4x/Kconfig.soc`.  
> –≠—Ç–æ –Ω–µ –ø–æ–ª–Ω–æ–µ –Ω–∞–∑–≤–∞–Ω–∏–µ —á–∏–ø–∞, –∞ ¬´–∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä¬ª SoC —Å–µ–º–µ–π—Å—Ç–≤–∞ STM32F401 (CE/VE/RE –∏ —Ç. –¥.).  
> –≠—Ç–æ—Ç —Å–∏–º–≤–æ–ª –≤–∫–ª—é—á–∞–µ—Ç –ø–æ–¥–¥–µ—Ä–∂–∫—É –Ω—É–∂–Ω–æ–≥–æ SoC –≤ Zephyr.

> –§–æ—Ä–º–∞—Ç –∏–º–µ–Ω–∏ —Ñ–∞–π–ª–∞: `Kconfig.BOARD_NAME`, –≤ –Ω–∞—à–µ–º —Å–ª—É—á–∞–µ `Kconfig.reddit_board`.

---

## üßæ –®–∞–≥ 2: –§–∞–π–ª `board.yml`

```bash
touch ~/zephyrproject/zephyr/boards/arm/reddit_board/board.yml
```

–°–æ–¥–µ—Ä–∂–∏–º–æ–µ:

```yaml
board:
  name: reddit_board
  full_name: reddit_board_v1
  vendor: st
  socs:
    - name: stm32f401xe
```

- `name:` ‚Äî –¥–æ–ª–∂–Ω–æ —Å–æ–≤–ø–∞–¥–∞—Ç—å —Å –∏–º–µ–Ω–µ–º `.dts` –∏ `Kconfig`
- `full_name:` ‚Äî –ø—Ä–æ–∏–∑–≤–æ–ª—å–Ω–æ–µ —á–µ–ª–æ–≤–µ–∫–æ–ø–æ–Ω—è—Ç–Ω–æ–µ –∏–º—è
- `socs:` ‚Äî —Å–ø–∏—Å–æ–∫ SoC, –∏—Å–ø–æ–ª—å–∑—É–µ–º—ã—Ö –Ω–∞ –ø–ª–∞—Ç–µ (–≤ –Ω–∞—à–µ–º —Å–ª—É—á–∞–µ –æ–¥–∏–Ω)

---

## üå≤ –®–∞–≥ 3: –§–∞–π–ª `reddit_board.dts`

```bash
touch ~/zephyrproject/zephyr/boards/arm/reddit_board/reddit_board.dts
```

–°–æ–¥–µ—Ä–∂–∏–º–æ–µ:

```dts
/dts-v1/; 													// Device Tree Source version 1 ‚Äî –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–π –∑–∞–≥–æ–ª–æ–≤–æ–∫
#include <st/f4/stm32f401xe.dtsi>							// –ë–∞–∑–æ–≤—ã–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è SoC STM32F401xE
#include <st/f4/stm32f401c(d-e)ux-pinctrl.dtsi>				// –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –ø–∏–Ω-–∫–æ–Ω—Ç—Ä–æ–ª—è STM32F401C(D/E)Ux
#include <zephyr/dt-bindings/input/input-event-codes.h>		// –ö–æ–¥—ã —Å–æ–±—ã—Ç–∏–π –≤–≤–æ–¥–∞ (–Ω–∞–ø—Ä–∏–º–µ—Ä, KEY_0)

/ {
	model = "Reddir v1 Board";								// –ß–µ–ª–æ–≤–µ–∫–æ–ø–æ–Ω—è—Ç–Ω–æ–µ –Ω–∞–∑–≤–∞–Ω–∏–µ –ø–ª–∞—Ç—ã
	compatible = "st,reddit_board";							// –°—Ç—Ä–æ–∫–∞ –¥–ª—è —Å–æ–ø–æ—Å—Ç–∞–≤–ª–µ–Ω–∏—è –≤ –¥—Ä–∞–π–≤–µ—Ä–∞—Ö

	chosen {
		zephyr,console = &usart1;							// USART1 –∫–∞–∫ —Å–∏—Å—Ç–µ–º–Ω–∞—è –∫–æ–Ω—Å–æ–ª—å
		zephyr,shell-uart = &usart1;						// USART1 –¥–ª—è –æ–±–æ–ª–æ—á–∫–∏
		zephyr,sram = &sram0;								// –û—Å–Ω–æ–≤–Ω–∞—è SRAM
		zephyr,flash = &flash0;								// –û—Å–Ω–æ–≤–Ω–∞—è Flash
	};

	leds {
		compatible = "gpio-leds";							// –£–∑–µ–ª –¥–ª—è GPIO-—Å–≤–µ—Ç–æ–¥–∏–æ–¥–æ–≤
		user_led: led {										// –ú–µ—Ç–∫–∞ –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–æ–≥–æ —Å–≤–µ—Ç–æ–¥–∏–æ–¥–∞
		gpios = <&gpioc 13 GPIO_ACTIVE_LOW>;			// –°–≤–µ—Ç–æ–¥–∏–æ–¥ –Ω–∞ PC13, –∞–∫—Ç–∏–≤–µ–Ω –ø–æ –Ω–∏–∑–∫–æ–º—É —É—Ä–æ–≤–Ω—é
			label = "User LED";								// –ú–µ—Ç–∫–∞ —Å–≤–µ—Ç–æ–¥–∏–æ–¥–∞
		};
	};

	gpio_keys {
		compatible = "gpio-keys";							// –£–∑–µ–ª –¥–ª—è –∫–Ω–æ–ø–æ–∫
		user_button: button {								// –ú–µ—Ç–∫–∞ –∫–Ω–æ–ø–∫–∏
		label = "KEY";									// –ú–µ—Ç–∫–∞ –∫–Ω–æ–ø–∫–∏
			gpios = <&gpioa 0 (GPIO_ACTIVE_LOW | GPIO_PULL_UP)>;	// –ö–Ω–æ–ø–∫–∞ –Ω–∞ PA0, –∞–∫—Ç–∏–≤–Ω–∞ –ø–æ –Ω–∏–∑–∫–æ–º—É —É—Ä–æ–≤–Ω—é —Å –ø–æ–¥—Ç—è–∂–∫–æ–π
			zephyr,code = <INPUT_KEY_0>;					// –õ–æ–≥–∏—á–µ—Å–∫–∏–π –∫–æ–¥, –Ω–∞–ø—Ä–∏–º–µ—Ä KEY_0
		};
	};

	aliases {
		led0 = &user_led;									// –ê–ª–∏–∞—Å led0
		sw0 = &user_button;									// –ê–ª–∏–∞—Å sw0
	};
};

&usart1 {
	pinctrl-0 = <&usart1_tx_pa9 &usart1_rx_pa10>;			// –ü–∏–Ω—ã TX/RX USART1: TX=PA9, RX=PA10
	pinctrl-names = "default";								// –ò–º—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ pinctrl
	status = "okay";										// –í–∫–ª—é—á–∏—Ç—å –ø–µ—Ä–∏—Ñ–µ—Ä–∏—é
	current-speed = <115200>;								// –°–∫–æ—Ä–æ—Å—Ç—å UART
};

&clk_hse {
	clock-frequency = <DT_FREQ_M(25)>;  					// –í–Ω–µ—à–Ω–∏–π –∫–≤–∞—Ä—Ü 25 –ú–ì—Ü
	status = "okay";										// –í–∫–ª—é—á–∏—Ç—å HSE
};

&pll {
	div-m = <25>;											// –î–µ–ª–∏—Ç–µ–ª—å –≤—Ö–æ–¥–∞ PLL
	mul-n = <200>;											// –ú–Ω–æ–∂–∏—Ç–µ–ª—å PLL
	div-p = <2>;											// –î–µ–ª–∏—Ç–µ–ª—å –≤—ã—Ö–æ–¥–∞ PLL
	div-q = <7>;											// –î–µ–ª–∏—Ç–µ–ª—å –¥—Ä—É–≥–æ–≥–æ –≤—ã—Ö–æ–¥–∞ PLL
	clocks = <&clk_hse>;									// –ò—Å—Ç–æ—á–Ω–∏–∫ PLL ‚Äî HSE
	status = "okay";										// –í–∫–ª—é—á–∏—Ç—å PLL
};

&rcc {
	clocks = <&pll>;										// –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å PLL –∫–∞–∫ —Å–∏—Å—Ç–µ–º–Ω—ã–π –∏—Å—Ç–æ—á–Ω–∏–∫
	clock-frequency = <DT_FREQ_M(100)>;						// –ò—Ç–æ–≥–æ–≤–∞—è —á–∞—Å—Ç–æ—Ç–∞ 100 –ú–ì—Ü
	ahb-prescaler = <1>;									// –î–µ–ª–∏—Ç–µ–ª—å AHB
	apb1-prescaler = <2>;									// –î–µ–ª–∏—Ç–µ–ª—å APB1 (–º–∞–∫—Å. 50 –ú–ì—Ü)
	apb2-prescaler = <1>;									// –î–µ–ª–∏—Ç–µ–ª—å APB2
};
```

> –ó–¥–µ—Å—å –∫–∞–∫ —Ä–∞–∑ –ø—Ä–∏–≥–æ–¥–∏—Ç—Å—è STM32CubeIDE –∏–ª–∏ STM32CubeMX ‚Äî –æ–Ω–∏ —É–ø—Ä–æ—â–∞—é—Ç –ø–æ–¥–±–æ—Ä –¥–µ–ª–∏—Ç–µ–ª–µ–π –∏ –º–Ω–æ–∂–∏—Ç–µ–ª–µ–π PLL/RCC.  
> –≠—Ç–æ—Ç `.dts` —Å–æ–¥–µ—Ä–∂–∏—Ç –º–∏–Ω–∏–º–∞–ª—å–Ω—ã–π –Ω–∞–±–æ—Ä –ø–µ—Ä–∏—Ñ–µ—Ä–∏–∏. –í —Å–ª–µ–¥—É—é—â–∏—Ö —Å—Ç–∞—Ç—å—è—Ö –º—ã –±—É–¥–µ–º –µ–≥–æ —Ä–∞—Å—à–∏—Ä—è—Ç—å.  
> –§–æ—Ä–º–∞—Ç –∏–º–µ–Ω–∏ —Ñ–∞–π–ª–∞: `BOARD_NAME.dts` ‚Äî —É –Ω–∞—Å `reddit_board.dts`.

üìò –û—Ñ–∏—Ü–∏–∞–ª—å–Ω—ã–π –≥–∞–π–¥ –ø–æ Devicetree:  
https://docs.zephyrproject.org/latest/build/dts/intro.html#devicetree-intro

---

## üß¨ –ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç —Ü–µ–ø–æ—á–∫–∞ –Ω–∞—Å–ª–µ–¥–æ–≤–∞–Ω–∏—è DTS (DeviceTree Chaining)

–ö–æ–≥–¥–∞ –≤—ã –≤–∫–ª—é—á–∞–µ—Ç–µ —Ç–∞–∫–æ–π —Ñ–∞–π–ª –≤ `reddit_board.dts`:

```dts
#include <st/f4/stm32f401xe.dtsi>
```

–í—ã –ø–æ–¥–∫–ª—é—á–∞–µ—Ç–µ –Ω–µ —Ç–æ–ª—å–∫–æ —ç—Ç–æ—Ç —Ñ–∞–π–ª ‚Äî –≤—ã –∑–∞–ø—É—Å–∫–∞–µ—Ç–µ **—Ü–µ–ø–æ—á–∫—É include**, –∫–æ—Ç–æ—Ä–∞—è –ø–æ–¥—Ç—è–≥–∏–≤–∞–µ—Ç –≤—Å—ë –±–æ–ª–µ–µ —Å–ø–µ—Ü–∏—Ñ–∏—á–Ω—ã–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏—è –¥–ª—è –≤–∞—à–µ–≥–æ SoC.

–¶–µ–ø–æ—á–∫–∞ –≤—ã–≥–ª—è–¥–∏—Ç —Ç–∞–∫:

```
skeleton.dtsi
  ‚îî‚îÄ‚îÄ armv7-m.dtsi
        ‚îî‚îÄ‚îÄ stm32f4.dtsi
              ‚îî‚îÄ‚îÄ stm32f401.dtsi
                    ‚îî‚îÄ‚îÄ stm32f401xe.dtsi   ‚Üê –º—ã –≤–∫–ª—é—á–∞–µ–º —ç—Ç–æ—Ç
```

–§–∞–π–ª—ã –Ω–∞—Ö–æ–¥—è—Ç—Å—è –∑–¥–µ—Å—å:

```
zephyr/dts/arm/st/f4/
```

–ö–∞–∂–¥—ã–π —Ñ–∞–π–ª –¥–æ–±–∞–≤–ª—è–µ—Ç —Å–≤–æ–π —Å–ª–æ–π:

| –§–∞–π–ª              | –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ                                            |
|-------------------|-------------------------------------------------------|
| `skeleton.dtsi`   | –ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–µ –±–∞–∑–æ–≤—ã–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –¥–ª—è –ª—é–±–æ–≥–æ devicetree |
| `armv7-m.dtsi`    | –û–±—â–∏–µ —É–∑–ª—ã –¥–ª—è ARM Cortex-M (CPU, NVIC, SysTick –∏ —Ç. –¥.)|
| `stm32f4.dtsi`    | –û–±—â–∏–µ —É–∑–ª—ã –¥–ª—è –≤—Å–µ—Ö STM32F4                           |
| `stm32f401.dtsi`  | –£–∑–ª—ã –¥–ª—è —Å–µ–º–µ–π—Å—Ç–≤–∞ STM32F401                          |
| `stm32f401xe.dtsi`| –ê–¥—Ä–µ—Å–∞ –ø–µ—Ä–∏—Ñ–µ—Ä–∏–∏, IRQ, —á–∞—Å—ã –¥–ª—è STM32F401xE           |

---

### üí° –ó–∞—á–µ–º —ç—Ç–æ –≤–∞–∂–Ω–æ?

–ü–æ—Ç–æ–º—É —á—Ç–æ –º—ã **–Ω–µ –ø–µ—Ä–µ–æ–ø—Ä–µ–¥–µ–ª—è–µ–º –≤—Å—ë —Å –Ω—É–ª—è**.  
–ü–æ–¥–∫–ª—é—á–∏–≤ `stm32f401xe.dtsi`, –º—ã –Ω–∞—Å–ª–µ–¥—É–µ–º –≤—Å—ë –∏–∑ —Ä–æ–¥–∏—Ç–µ–ª—å—Å–∫–∏—Ö —Ñ–∞–π–ª–æ–≤: –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ CPU, –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä –ø—Ä–µ—Ä—ã–≤–∞–Ω–∏–π, –±–∞–∑–æ–≤—É—é –∫–∞—Ä—Ç—É –ø–∞–º—è—Ç–∏, –¥–µ—Ä–µ–≤—å—è —Ç–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –∏ —Ç. –¥.

–≠—Ç–æ –ø–æ–∑–≤–æ–ª—è–µ—Ç —Å–æ—Å—Ä–µ–¥–æ—Ç–æ—á–∏—Ç—å—Å—è —Ç–æ–ª—å–∫–æ –Ω–∞ —Ç–æ–º, —á—Ç–æ **—É–Ω–∏–∫–∞–ª—å–Ω–æ –¥–ª—è –≤–∞—à–µ–π –ø–ª–∞—Ç—ã**:

- GPIO –¥–ª—è —Å–≤–µ—Ç–æ–¥–∏–æ–¥–æ–≤ –∏ –∫–Ω–æ–ø–æ–∫
- –ù–∞–∑–Ω–∞—á–µ–Ω–∏—è –≤—ã–≤–æ–¥–æ–≤
- –í–Ω–µ—à–Ω—è—è –ø–µ—Ä–∏—Ñ–µ—Ä–∏—è (SPI-—Ñ–ª–µ—à, —Å–µ–Ω—Å–æ—Ä—ã)
- –ò—Å—Ç–æ—á–Ω–∏–∫ —Ç–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –∏ PLL

–ú–æ–∂–Ω–æ –¥—É–º–∞—Ç—å –æ–± —ç—Ç–æ–º –∫–∞–∫ –æ –Ω–∞—Å–ª–µ–¥–æ–≤–∞–Ω–∏–∏ –∫–ª–∞—Å—Å–æ–≤ –∏–ª–∏ —Å–ª–æ–∏—Å—Ç–æ–π –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏.

üìò –û—Ñ–∏—Ü–∏–∞–ª—å–Ω—ã–π –≥–∞–π–¥ Devicetree:  
https://docs.zephyrproject.org/latest/build/dts/intro.html#devicetree-intro

---

## üß© –®–∞–≥ 4: –§–∞–π–ª `reddit_board_defconfig`

```bash
touch ~/zephyrproject/zephyr/boards/arm/reddit_board/reddit_board_defconfig
```

–°–æ–¥–µ—Ä–∂–∏–º–æ–µ:

```kconfig
# SPDX-License-Identifier: Apache-2.0

CONFIG_ARM_MPU=y
CONFIG_HW_STACK_PROTECTION=y

CONFIG_SERIAL=y
CONFIG_UART_INTERRUPT_DRIVEN=y
CONFIG_CONSOLE=y
CONFIG_UART_CONSOLE=y

CONFIG_GPIO=y

CONFIG_SHELL=y
CONFIG_KERNEL_SHELL=y
CONFIG_SHELL_BACKEND_SERIAL=y
```

> –≠—Ç–æ—Ç —Ñ–∞–π–ª –Ω–µ–æ–±—è–∑–∞—Ç–µ–ª–µ–Ω, –Ω–æ –∫—Ä–∞–π–Ω–µ —É–¥–æ–±–µ–Ω!  
> –û–Ω –∑–∞–¥–∞—ë—Ç –¥–µ—Ñ–æ–ª—Ç–Ω—ã–µ –æ–ø—Ü–∏–∏ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ –¥–ª—è –≤–∞—à–µ–π –ø–ª–∞—Ç—ã –ø—Ä–∏ —Å–±–æ—Ä–∫–µ. –ó–¥–µ—Å—å –º—ã –≤–∫–ª—é—á–∏–ª–∏ UART –∏ –æ–±–æ–ª–æ—á–∫—É ‚Äî —ç—Ç–æ –æ—á–µ–Ω—å –ø–æ–ª–µ–∑–Ω–æ –¥–ª—è –æ—Ç–ª–∞–¥–∫–∏.

---

## ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏

–ê–∫—Ç–∏–≤–∏—Ä—É–π—Ç–µ –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–µ –æ–∫—Ä—É–∂–µ–Ω–∏–µ Python:

```bash
source ~/zephyrproject/.venv/bin/activate
```

–ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ –ø–ª–∞—Ç–∞ –æ–±–Ω–∞—Ä—É–∂–∏–≤–∞–µ—Ç—Å—è:

```bash
cd ~/zephyrproject/zephyr/samples/basic/blinky
west boards | grep reddit
# ‚Üí reddit_board
```

---

## üöÄ –°–±–æ—Ä–∫–∞ –ø—Ä–∏–º–µ—Ä–∞

–ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ –ø–∞–ø–∫—É —Å –ø—Ä–∏–º–µ—Ä–æ–º:

```bash
cd ~/zephyrproject/zephyr/samples/basic/blinky
```

–°–æ–±–µ—Ä–∏—Ç–µ –ø—Ä–æ–µ–∫—Ç:

```bash
west build -p always -b reddit_board
```

–†–µ–∑—É–ª—å—Ç–∞—Ç:

```bash
~/zephyrproject/zephyr/samples/basic/blinky/build/zephyr/zephyr.hex
```

–ü—Ä–æ—à–µ–π—Ç–µ —ç—Ç–æ—Ç `.hex` –≤ **STM32F401CEU6** —á–µ—Ä–µ–∑ DFU –∏–ª–∏ ST-Link.  
–ï—Å–ª–∏ –≤—Å—ë —Å–¥–µ–ª–∞–Ω–æ –ø—Ä–∞–≤–∏–ª—å–Ω–æ, —Å–≤–µ—Ç–æ–¥–∏–æ–¥ –±—É–¥–µ—Ç –º–∏–≥–∞—Ç—å, –∞ –æ–±–æ–ª–æ—á–∫–∞ –±—É–¥–µ—Ç –¥–æ—Å—Ç—É–ø–Ω–∞ –Ω–∞ UART1 (PA9/PA10) @ 115200 –±–æ–¥.

---

## üêû –ß–∞—Å—Ç—ã–µ –æ—à–∏–±–∫–∏

- `defined without a type` ‚Äî –ø—Ä–æ–≤–µ—Ä—å—Ç–µ `select SOC_...` –∏ –ø—Ä–∞–≤–∏–ª—å–Ω–æ—Å—Ç—å –∏–º–µ–Ω–∏ SoC
- `BOARD_REDDIT_BOARD` ‚Äî –¥–æ–ª–∂–Ω–æ –Ω–∞—á–∏–Ω–∞—Ç—å—Å—è —Å `BOARD_`
- –ü–ª–∞—Ç–∞ –Ω–µ –≤–∏–¥–Ω–∞ –≤ `west boards` ‚Äî –ø—Ä–æ–≤–µ—Ä—å—Ç–µ `board.yml` –∏ –ø—É—Ç–∏
- –í–∞–∂–Ω–æ: —ç—Ç–æ `board.yml`, **–Ω–µ** `board.yaml`!

---

## üß∑ –ó–∞–∫–ª—é—á–µ–Ω–∏–µ

–í—ã —Ç–æ–ª—å–∫–æ —á—Ç–æ —Å–æ–∑–¥–∞–ª–∏ —Å–æ–±—Å—Ç–≤–µ–Ω–Ω–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ –ø–ª–∞—Ç—ã –≤ Zephyr! üéâ  
–î–∞–ª—å—à–µ ‚Äî –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ –≤–Ω–µ—à–Ω–µ–π –ø–∞–º—è—Ç–∏ W25Q128, SPI, I2C –∏ –¥—Ä—É–≥–∏—Ö –ø–µ—Ä–∏—Ñ–µ—Ä–∏–π–Ω—ã—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤.

> –í—Å–µ —Ñ–∞–π–ª—ã –¥–ª—è —ç—Ç–æ–π –ø–ª–∞—Ç—ã –º–æ–∂–Ω–æ –Ω–∞–π—Ç–∏ –≤ —ç—Ç–æ–º –∫–æ–º–º–∏—Ç–µ: [GitHub link]

üìò –û—Ñ–∏—Ü–∏–∞–ª—å–Ω—ã–π –≥–∞–π–¥ –ø–æ –ø–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω–∏—é –ø–ª–∞—Ç:  
https://docs.zephyrproject.org/latest/hardware/porting/board_porting.html

–ù–∞–ø–∏—à–∏—Ç–µ –≤ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏—è—Ö, –µ—Å–ª–∏ —Ö–æ—Ç–∏—Ç–µ —É–≤–∏–¥–µ—Ç—å —Å–ª–µ–¥—É—é—â—É—é —Å—Ç–∞—Ç—å—é —Ä–∞–Ω—å—à–µ üòÑ
